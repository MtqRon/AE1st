# 行列の理論と応用 - 6月総合まとめ

## 目次
1. [基本概念](#1-基本概念)
2. [線形写像と行列](#2-線形写像と行列)
3. [逆行列と行列式](#3-逆行列と行列式)
4. [固有値と固有ベクトル](#4-固有値と固有ベクトル)
5. [対角化](#5-対角化)
6. [正規直交化と直交行列](#6-正規直交化と直交行列)
7. [二次形式と標準形](#7-二次形式と標準形)
8. [重積分での応用](#8-重積分での応用)
9. [実践的なコツと注意点](#9-実践的なコツと注意点)

---

## 1. 基本概念

### 1.1 線形性の定義
線形写像とは以下の2つの性質を満たす写像のこと：

**加法性（和を保つ）**：$f(u+v) = f(u) + f(v)$
- 「別々に入力をして足し合わせた結果」と「足し合わせてから入力した結果」が同じ
- 例：ジンとトニックウォーターをコップAで混ぜてからコップBに注いだ時と、コップBにジンとトニックを直で注いだ時に味が変わらない

**斉次性（スカラー倍を保つ）**：$f(cu) = cf(u)$
- 「入力をc倍してから写像する」のと「写像してから結果をc倍する」のが同じ
- 例：レシピの材料を全部2倍にしてから二人分の料理を作るのと、等倍の材料で料理を2人分作るのが一緒

### 1.2 ベクトル空間と部分空間
**部分空間の証明に必要な3条件**：
1. 和について閉じている
2. スカラー倍について閉じている
3. ゼロベクトルを含む

これは「ある集合がベクトル空間としての性質を持っているか」を判定している。

---

## 2. 線形写像と行列

### 2.1 行列と線形写像の関係
あるベクトルに行列を「作用させる」（かけ合わせる）と新しいベクトルに変換される。
この「行列によるベクトルの変換」こそが線形写像そのもの。

**直感的理解**：
- 画用紙：ベクトル空間（絵を描ける場所）
- 画用紙の操作（回転させる、伸ばす、ゆがませる）：線形写像

### 2.2 基底と表現行列（6月3日）
**基底と座標ベクトル**：
- あるベクトル空間$V$のベクトル$v$があるとき、$V$の基底を$\{b_1, b_2, \cdots, b_n\}$とする
- ベクトル$v$は基底ベクトルの線形結合として表現：$v = c_1b_1 + c_2b_2 + \cdots + c_nb_n$
- 係数の組$(c_1, c_2, \cdots, c_n)^T$を**座標ベクトル**（成分表示）と呼ぶ
- 座標ベクトルは基底ありきのものであることに注意

**重要なポイント**：
- 基底（表現に使用するパーツ）が変わると線形写像の表現行列（設計図）も変わる
- 入力側と出力側の基底を定めてから初めて一意に表現行列が決まる
- 基底（パーツ）と表現行列（設計書）が変わっても、行っている操作（完成品）は同じ

### 2.3 表現行列と座標ベクトル
**重要な理解**：
- 表現行列$A$は、入力ベクトルの「座標」を、出力ベクトルの「座標」に変換する
- 行列$A$は直接ベクトルの実体に作用するのではなく、「座標」に作用する
- 入力空間と出力空間が一緒で、基底も同じ（例：両方標準基底）という場合は、入力と出力の座標を実体化させる基底行列が単位行列になるので、ベクトルの実体に表現行列が作用しているように見える

---

## 3. 逆行列と行列式

### 3.1 逆行列の計算手順（6月6日）
$A^{-1}$を求める際の正確な手順：

1. **余行列**を並べる
2. 余行列の**転置**をとる
3. **行列式**を求める
4. 行列式の**逆数**をとる
5. それを余行列の転置にかける

**注意点**：余因子を転置しながら並べたりすると、行列式の値をかけ忘れたりするので、一つ一つ正確に手順通りに行う。特に、行列は一つ計算ミスをすると、その後の計算が全て間違いになるので、慎重に計算する。

### 3.2 行列式の計算における注意点（6月5日）
ある定数（$a$）などが入った行列式に行基本変形を施すとき、$a$が入った式で行に対する割り算を行うときは、その式が$0$にならないことを確認してから行う。

---

## 4. 固有値と固有ベクトル

### 4.1 基本定義（6月7日）
**固有値**：$\lambda$は固有多項式$\det(A - \lambda I)$を解くことで求まる。

**固有ベクトル**：$\lambda$に対する固有ベクトルは$(A - \lambda I)v = 0$を満たすベクトルであり、行列$A - \lambda I$の核に属する。

**物理的意味**：行列$A$が固有ベクトル$v$に対して単に$\lambda$倍するということ。

### 4.2 固有値・固有ベクトルの具体的な求め方（6月18日）
**固有値と固有ベクトルの定義**：
$$
\begin{align*}
    A\mathbf{v} &= \lambda \mathbf{v} \\
    (A - \lambda I)\mathbf{v} &= 0
\end{align*}
$$

**$\lambda_1$に対応する固有ベクトルの求め方**：
$$
\begin{pmatrix}
a - \lambda_1 & b \\
b & c - \lambda_1
\end{pmatrix} \begin{pmatrix}
\mathbf{v}_1 \\
\mathbf{v}_2
\end{pmatrix} = \begin{pmatrix}0 \\
0\end{pmatrix}
$$

固有ベクトルは：
$$
(a - \lambda_1)\mathbf{v}_1 + b\mathbf{v}_2 = 0
$$
より、
$$
\mathbf{v}_2 = -\frac{(a - \lambda_1)}{b}\mathbf{v}_1
$$

したがって、$\lambda_1$に対応する固有ベクトルは：
$$
\begin{pmatrix}b \\
\lambda_1 - a\end{pmatrix}
$$

---

## 5. 対角化

### 5.1 対角化の条件と利点（6月6日）
n次の正方行列において、n本の一次独立な固有ベクトルを取れるとき、その行列は固有ベクトルを並べた行列$P$によって対角化可能である。

**利点**：対角化すると$A^n$などの計算が容易になる。

### 5.2 ケーリー・ハミルトンの定理（6月5日）
固有多項式を$f_A(x)$とするとき、$f_A(A) = O$

**応用**：余りや$A^n$を求める問題で、固有値が重解になったときは式を微分する（なぜかは分からないが式が2つ出てくるのは間違いない）

---

## 6. 正規直交化と直交行列

### 6.1 グラム・シュミットの正規直交化（6月7日）
グラムシュミットの直交化法を使用するとベクトルを正規直交化することができる。

**実対称行列の特別な性質**：
- **重複しない固有値の場合**：対応する固有ベクトルはすでに直交しており、それぞれ正規化するだけで正規直交行列をつくることができる
- **重解の場合**：グラムシュミットの正規直交化を使用することで正規直交行列を作ることができる

### 6.2 正規直交行列の性質（6月7日、6月18日）
正規直交行列は$P^t = P^{-1}$である。

この行列を使用し$\begin{pmatrix} x \\ y \end{pmatrix} = P \begin{pmatrix} X \\ Y \end{pmatrix}$とすることで2次形式から標準形に直すことができる。

**正規直交行列$P$の性質**：
$$
\begin{align*}
P^T P &= I \\
P^{-1} &= P^T \\
\det(P) &= +1, -1
\end{align*}
$$

ここで、$\det(P)$が+1ならば回転、-1ならば回転+鏡映である。

### 6.3 直交行列の詳細な性質（6月17日）
**定義**：実正方行列 A が直交行列であるとは、以下を満たすこと：
$$
A^T A = AA^T = I
$$

**重要な性質**：
1. **逆行列＝転置行列**：$A^{-1} = A^T$
2. **行列式**：$\det(A) = \pm 1$
3. **列ベクトルの正規直交性**：A の列ベクトルは正規直交基底を成す
4. **内積の保存**：$\langle Ax, Ay \rangle = \langle x, y \rangle$
5. **ベクトルの長さの保存**：$\|Ax\| = \|x\|$

**具体例**：回転行列は直交行列の典型例
$$
R(\theta) = \begin{pmatrix}
\cos\theta & -\sin\theta \\
\sin\theta & \cos\theta
\end{pmatrix}
$$

---

## 7. 二次形式と標準形

### 7.1 二次形式の行列表現（6月18日）
二次形式を以下のように表現：
$$
ax^2 + 2bxy + cy^2 = (x \quad y) \begin{pmatrix}
a & b \\
b & c
\end{pmatrix} \begin{pmatrix}x \\
y\end{pmatrix}
$$

### 7.2 標準形への変換手順（6月18日）
1. 行列の固有値$\lambda_1, \lambda_2$を求める
2. 対応する固有ベクトルを求めて正規化
3. 正規直交行列$P$を構成
4. 座標変換：$\begin{pmatrix}x \\ y \end{pmatrix} = P \begin{pmatrix}z_1 \\ z_2 \end{pmatrix}$
5. 二次形式が$\lambda_1 z_1^2 + \lambda_2 z_2^2$に変形される

**詳細な計算過程**：
$$
\begin{pmatrix}x & y \end{pmatrix} A \begin{pmatrix}x \\ y \end{pmatrix}
= \begin{pmatrix}z_1 & z_2 \end{pmatrix} P^T A P \begin{pmatrix}z_1 \\ z_2 \end{pmatrix}
= \begin{pmatrix}z_1 & z_2 \end{pmatrix} \begin{pmatrix}\lambda_1 & 0 \\
0 & \lambda_2
\end{pmatrix} \begin{pmatrix}z_1 \\ z_2 \end{pmatrix}
= \lambda_1 z_1^2 + \lambda_2 z_2^2
$$

### 7.3 円への標準化（6月18日）
楕円の半径を1にするための変数変換：
$$
u = \sqrt{\lambda_1} z_1, \quad v = \sqrt{\lambda_2} z_2
$$

この変換により二次形式は$u^2 + v^2$となる。

**変換行列**：
$$
T = \begin{pmatrix} \sqrt{\lambda_1} & 0 \\
0 & \sqrt{\lambda_2} \end{pmatrix} P^T
$$

### 7.4 標準形の幾何学的意味（6月7日）
$$
\begin{align*}
x^2 + y^2 &= 1 \quad \text{(円)} \\
\frac{x^2}{a^2} + \frac{y^2}{b^2} &= 1 \quad \text{(楕円)} \\
\frac{x^2}{a^2} - \frac{y^2}{b^2} &= 1 \quad \text{(双曲線)}
\end{align*}
$$

---

## 8. 重積分での応用

### 8.1 ヤコビアンと行列式（6月18日）
行列式の値は、その行列で変換されるときの面積や体積の変化率を表す。

変数変換におけるヤコビアン：
$$
dxdy = \frac{1}{|\det(T)|} dudv
$$

### 8.2 ガウス積分への応用（6月18日）
$$
\int_{-\infty}^{\infty} \int_{-\infty}^{\infty} e^{-(ax^2 + 2bxy + cy^2)} dxdy = \frac{\pi}{\sqrt{ac - b^2}}
$$

**計算の流れ**：
$$
\int_{-\infty}^{\infty} \int_{-\infty}^{\infty} e^{-(ax^2 + 2bxy + cy^2)} dxdy
= \int_{-\infty}^{\infty} \int_{-\infty}^{\infty} e^{-(u^2 + v^2)} \frac{1}{|\det(T)|} dudv
= \frac{\pi}{\sqrt{ac - b^2}}
$$

---

## 9. 実践的なコツと注意点

### 9.1 計算における注意点
1. **計算の正確性**：行列は一つ計算ミスをすると、その後の計算が全て間違いになるので、慎重に計算する
2. **自己検証**：つねにこれであっているのか、整合性はあるか自分を疑うこと
3. **手順の遵守**：特に逆行列計算では、正確な手順を一つずつ守ること

### 9.2 重要な性質の記憶
1. **実対称行列の性質**：重解でない限り固有ベクトルは直交する
2. **空間の自由度**：空間の自由度はその空間の次元となる
3. **KerやImの次元**：変数の数 - rank = dim が求まる

### 9.3 頻出問題パターン
1. **二次形式を標準形に戻す問題**：入試においては頻出
2. **固有値が重解の場合**：ケーリー・ハミルトンの定理応用では式を微分する
3. **行列式計算**：定数が含まれる場合は分母が0でないことを確認

---

## 参考文献
- 6月3日学習ノート：線形写像と行列の関係
- 6月5日〜6月19日学習ノート：行列理論全般
- 6月18日学習ノート：二次形式と重積分応用

---

*このまとめは6月の学習内容を総合的に整理したものです。実際の問題解決では、これらの理論を組み合わせて応用することが重要です。*
